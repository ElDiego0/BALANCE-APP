<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BALANCE</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0f172a">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      background: #020617;
      color: #e5e7eb;
    }

    header {
      text-align: center;
      padding: 24px;
    }

    header img {
      width: 80px;
      margin-bottom: 12px;
    }

    h1 {
      margin: 0;
      font-size: 28px;
    }

    .container {
      padding: 16px;
      max-width: 900px;
      margin: auto;
    }

    .card {
      background: #020617;
      border: 1px solid #1e293b;
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .investments button {
      margin: 6px;
      padding: 10px 14px;
      border-radius: 12px;
      border: none;
      background: #1e293b;
      color: white;
      cursor: pointer;
    }

    canvas {
      height: 260px !important;
    }

    /* Riesgo */
    .risk {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 12px;
      margin-top: 8px;
    }

    .risk.bajo { background:#064e3b; color:#4ade80; }
    .risk.medio { background:#78350f; color:#facc15; }
    .risk.alto { background:#7f1d1d; color:#fb7185; }

    /* Quiz */
    .quiz {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .quiz.hidden { display: none; }

    .quiz-box {
      background: #020617;
      padding: 24px;
      border-radius: 16px;
      width: 90%;
      max-width: 380px;
      text-align: center;
    }

    .quiz-box button {
      width: 100%;
      margin: 8px 0;
      padding: 12px;
      border-radius: 12px;
      border: none;
      background: #1e293b;
      color: white;
      font-size: 15px;
    }
  </style>
</head>

<body>

<header>
  <img src="icon-512.png" alt="BALANCE logo">
  <h1>BALANCE</h1>
  <p>Invertir sin miedo</p>
</header>

<div class="container">

  <div id="welcomeBox" class="card"></div>

  <div class="card investments">
    <h3>游늵 Inversiones</h3>
    <button onclick="selectAsset('SPY')">SPY</button>
    <button onclick="selectAsset('VUG')">VUG</button>
    <button onclick="selectAsset('SCHD')">SCHD</button>
    <button onclick="selectAsset('VEA')">VEA</button>
    <button onclick="selectAsset('GLD')">GLD</button>
    <button onclick="selectAsset('BOTZ')">BOTZ</button>
    <button onclick="selectAsset('ARGT')">ARGT</button>
  </div>

  <div class="card">
    <canvas id="chart"></canvas>
  </div>

  <div id="details" class="card"></div>

  <div class="card">
    <h3>游닂 Aprender en 1 minuto</h3>
    <ul>
      <li>Un ETF agrupa muchas inversiones.</li>
      <li>Diversificar reduce riesgos extremos.</li>
      <li>El largo plazo suele ser clave.</li>
      <li>M치s riesgo implica m치s subidas y bajadas.</li>
    </ul>
  </div>

</div>

<!-- QUIZ -->
<div id="quizOverlay" class="quiz hidden">
  <div class="quiz-box">
    <h2 id="quizQuestion"></h2>
    <div id="quizAnswers"></div>
    <div id="quizProgress"></div>
  </div>
</div>

<script>
/* Colores por activo */
const assetColors = {
  SPY: "#4ade80",
  VUG: "#60a5fa",
  SCHD: "#a78bfa",
  VEA: "#facc15",
  GLD: "#f59e0b",
  BOTZ: "#fb7185",
  ARGT: "#38bdf8"
};

/* Info educativa */
const investments = {
  SPY: { name:"S&P 500", risk:"Medio", desc:"Representa las 500 empresas m치s grandes de EE.UU." },
  VUG: { name:"Growth", risk:"Medio-Alto", desc:"Empresas con alto crecimiento esperado." },
  SCHD:{ name:"Dividendos", risk:"Bajo-Medio", desc:"Empresas con pagos estables de dividendos." },
  VEA:{ name:"Internacional", risk:"Medio", desc:"Mercados desarrollados fuera de EE.UU." },
  GLD:{ name:"Oro", risk:"Bajo", desc:"Activo refugio contra crisis." },
  BOTZ:{ name:"Rob칩tica & IA", risk:"Alto", desc:"Tecnolog칤a e innovaci칩n." },
  ARGT:{ name:"Argentina", risk:"Muy Alto", desc:"Mercado emergente vol치til." }
};

/* Mensaje perfil */
const profileMessages = {
  conservador:"Busc치s estabilidad y tranquilidad.",
  moderado:"Busc치s crecer con equilibrio.",
  agresivo:"Prioriz치s crecimiento a largo plazo."
};

const profile = localStorage.getItem("investorProfile");
if (profile) {
  document.getElementById("welcomeBox").innerHTML =
    `<h3>Perfil ${profile}</h3><p>${profileMessages[profile]}</p>`;
}

/* Gr치fico */
let chart;
function renderChart(symbol) {
  if (chart) chart.destroy();

  const data = Array.from({length:60},(_,i)=>i+Math.random()*10);

  chart = new Chart(document.getElementById("chart"), {
    type: "line",
    data: {
      labels: data.map((_,i)=>i),
      datasets: [{
        label: symbol,
        data,
        borderColor: assetColors[symbol],
        tension: 0.4
      }]
    },
    options: { responsive:true, maintainAspectRatio:false }
  });
}

/* Detalles */
function renderRisk(level){
  const map={Bajo:"bajo",Medio:"medio","Medio-Alto":"alto",Alto:"alto","Muy Alto":"alto"};
  return `<span class="risk ${map[level]}">Riesgo ${level}</span>`;
}

function selectAsset(symbol){
  renderChart(symbol);
  const i = investments[symbol];
  document.getElementById("details").innerHTML = `
    <h3>${i.name}</h3>
    ${renderRisk(i.risk)}
    <p>${i.desc}</p>
    <p><strong>Educativo:</strong> este activo puede subir y bajar. El tiempo suele ser clave.</p>
  `;
}

/* Quiz inversor */
const quizData=[
  {q:"쮺칩mo te sent칤s con las ca칤das?",a:[{t:"Prefiero estabilidad",v:0},{t:"Me adapto",v:1},{t:"No me molesta",v:2}]},
  {q:"쮺u치ndo usar칤as ese dinero?",a:[{t:"< 2 a침os",v:0},{t:"3-5 a침os",v:1},{t:"> 5 a침os",v:2}]},
  {q:"쯈u칠 prioriz치s?",a:[{t:"No perder",v:0},{t:"Equilibrio",v:1},{t:"Crecimiento",v:2}]},
  {q:"Si cae 20%...",a:[{t:"Vendo",v:0},{t:"Espero",v:1},{t:"Compro m치s",v:2}]}
];

let qi=0,score=0;
const overlay=document.getElementById("quizOverlay");
const qEl=document.getElementById("quizQuestion");
const aEl=document.getElementById("quizAnswers");
const pEl=document.getElementById("quizProgress");

function showQuiz(){
  overlay.classList.remove("hidden");
  renderQ();
}
function renderQ(){
  const q=quizData[qi];
  qEl.textContent=q.q;
  aEl.innerHTML="";
  pEl.textContent=`${qi+1}/${quizData.length}`;
  q.a.forEach(o=>{
    const b=document.createElement("button");
    b.textContent=o.t;
    b.onclick=()=>{score+=o.v;qi++;qi<quizData.length?renderQ():finishQuiz();};
    aEl.appendChild(b);
  });
}
function finishQuiz(){
  let p="moderado";
  if(score<=3)p="conservador";
  if(score>=8)p="agresivo";
  localStorage.setItem("investorProfile",p);
  overlay.classList.add("hidden");
  location.reload();
}
if(!localStorage.getItem("investorProfile")) showQuiz();

/* Service Worker */
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>

